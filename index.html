<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API Example</title>
</head>
<body>
  <h1>Google Sheets Data Manager</h1>
  
  <div>
    <h2>Write Data</h2>
    <form id="writeForm">
      <input type="text" id="name" placeholder="Name" required>
      <input type="email" id="email" placeholder="Email" required>
      <button type="submit">Save to Sheet</button>
    </form>
  </div>
  
  <div>
    <h2>Read Data</h2>
    <button id="readData">Load Sheet Data</button>
    <div id="output"></div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxOpf01vbYCMOICIDPXLsKDtVjA9uc51Ai4wu4gF5j87It-l8V1ZdAeM1ABMIfg6q2H/exec"; // Replace with your URL

    // Write data to sheet
    document.getElementById("writeForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const data = [
        document.getElementById("name").value,
        document.getElementById("email").value,
        new Date().toLocaleString()
      ];

      try {
        const response = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            action: "write",
            sheetName: "Contacts",
            data: data
          })
        });
        
        const result = await response.json();
        alert(`Success! ${result.rowsAdded} row(s) added.`);
        e.target.reset();
      } catch (error) {
        console.error("Error:", error);
        alert("Failed to save data");
      }
    });

    // Read data from sheet
    document.getElementById("readData").addEventListener("click", async () => {
      try {
        const response = await fetch(`${SCRIPT_URL}?action=read&sheetName=Contacts`);
        const result = await response.json();
        
        if (result.status === "success") {
          const outputDiv = document.getElementById("output");
          outputDiv.innerHTML = "<h3>Sheet Data:</h3>";
          
          const table = document.createElement("table");
          table.border = "1";
          
          result.data.forEach(row => {
            const tr = document.createElement("tr");
            row.forEach(cell => {
              const td = document.createElement("td");
              td.textContent = cell;
              tr.appendChild(td);
            });
            table.appendChild(tr);
          });
          
          outputDiv.appendChild(table);
        }
      } catch (error) {
        console.error("Error:", error);
        alert("Failed to load data");
      }
    });
  </script>
</body>
</html>
